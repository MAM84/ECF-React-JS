{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/marionmetais/Documents/Exercices/React JS/Projets/ecf deploiement/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _classCallCheck from\"/Users/marionmetais/Documents/Exercices/React JS/Projets/ecf deploiement/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/marionmetais/Documents/Exercices/React JS/Projets/ecf deploiement/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/marionmetais/Documents/Exercices/React JS/Projets/ecf deploiement/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/marionmetais/Documents/Exercices/React JS/Projets/ecf deploiement/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import'./App.css';import Header from'./components/Header';import SearchForm from'./components/SearchForm';import ResultsTable from'./components/ResultsTable';import Response from'./components/Response';import Modal from'./components/Modal';import{sendSearch}from'./api/musicBrainzAPI';import{sendSearchDetails}from'./api/musicBrainzAPI';import{sendSearchCover}from'./api/musicBrainzAPI';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.submit=function(ev){ev.preventDefault();var _ev$target=ev.target,addSearch=_ev$target.addSearch,addSelect=_ev$target.addSelect;_this.setState({\"responsesList\":[],\"addSearch\":addSearch.value,\"addSelect\":addSelect.value});_this.offset=0;sendSearch(addSelect.value,addSearch.value,_this.offset,_this.addResponse);};_this.clickSeeMore=function(){var _this$state=_this.state,addSearch=_this$state.addSearch,addSelect=_this$state.addSelect;_this.offset+=100;sendSearch(addSelect,addSearch,_this.offset,_this.addResponse);};_this.addResponse=function(response){var responsesList=_this.state.responsesList;response.recordings.map(function(a){var _a$artistCredit,_a$releases;return responsesList.push({\"artistName\":(_a$artistCredit=a[\"artist-credit\"])===null||_a$artistCredit===void 0?void 0:_a$artistCredit[0].name,\"titleName\":a===null||a===void 0?void 0:a.title,\"albumName\":(_a$releases=a[\"releases\"])===null||_a$releases===void 0?void 0:_a$releases[0].title,\"idRecording\":a===null||a===void 0?void 0:a.id});});_this.setState({\"responsesList\":responsesList});//pour gérer l'apparition ou non du bouton \"voir plus\"\nif(_this.offset+100<response.count){_this.setState({\"seeMore\":true});}else{_this.setState({\"seeMore\":false});}//pour gérer l'apparition ou non du tableau des résultats ou d'un texte\nif(response.count>0){_this.setState({\"visuResult\":true,\"makeSearch\":false,\"emptyResult\":false,\"nbResult\":response.count});}else{_this.setState({\"visuResult\":false,\"makeSearch\":false,\"emptyResult\":true});}};_this.clickOnModal=function(idRecording){document.body.classList.add(\"bodyModalOpen\");var visualModal=_this.state.visualModal;_this.setState({\"visualModal\":!visualModal,\"loader\":\"loader\"});sendSearchDetails(idRecording,_this.addDetails);};_this.addDetails=function(response){var _response$artistCred,_response$rating,_response$rating2;var responseDetail=_this.state.responseDetail;var artists=[];var _iterator=_createForOfIteratorHelper(response[\"artist-credit\"]),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var artist=_step.value;artists.push(artist.name);}}catch(err){_iterator.e(err);}finally{_iterator.f();}var releases=[];var _iterator2=_createForOfIteratorHelper(response[\"releases\"]),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var release=_step2.value;releases.push(release.title);}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}var genres=[];var _iterator3=_createForOfIteratorHelper(response===null||response===void 0?void 0:response.genres),_step3;try{for(_iterator3.s();!(_step3=_iterator3.n()).done;){var genre=_step3.value;genres.push(genre.name);}}catch(err){_iterator3.e(err);}finally{_iterator3.f();}var length=response===null||response===void 0?void 0:response.length;var minuts=Math.floor(length/1000/60);var seconds=Math.floor(length/1000%60);responseDetail.push({\"titleName\":response===null||response===void 0?void 0:response.title,\"artistName\":((_response$artistCred=response[\"artist-credit\"])===null||_response$artistCred===void 0?void 0:_response$artistCred.length)===0?\"Indisponible\":artists.join(', '),\"albumName\":response[\"releases\"].length===0?\"Indisponible\":releases.join(', '),\"genre\":(response===null||response===void 0?void 0:response.genres.length)===0?\"Indisponible\":genres.join(', '),\"length\":minuts+'mn '+seconds+\"s\",\"rating\":((_response$rating=response[\"rating\"])===null||_response$rating===void 0?void 0:_response$rating.value)===null?\"Indisponible\":((_response$rating2=response[\"rating\"])===null||_response$rating2===void 0?void 0:_response$rating2.value)+\"/5\"});_this.setState({\"responseDetail\":responseDetail});//récupération des id albums pour les covers\n_this.setState({\"coversList\":[],\"cover\":\"\"});var idReleases=[];var _iterator4=_createForOfIteratorHelper(response[\"releases\"]),_step4;try{for(_iterator4.s();!(_step4=_iterator4.n()).done;){var _release=_step4.value;idReleases.push(_release.id);}}catch(err){_iterator4.e(err);}finally{_iterator4.f();}for(var _i=0,_idReleases=idReleases;_i<_idReleases.length;_i++){var idRelease=_idReleases[_i];sendSearchCover(idRelease,_this.addCover);}};_this.addCover=function(responseCover){if(responseCover===\"noCover\"){_this.setState({\"cover\":false,\"loader\":\"\"});}else{var coversList=_this.state.coversList;var _iterator5=_createForOfIteratorHelper(responseCover.images),_step5;try{for(_iterator5.s();!(_step5=_iterator5.n()).done;){var cover=_step5.value;coversList.push({\"url\":cover['thumbnails'].small});}}catch(err){_iterator5.e(err);}finally{_iterator5.f();}_this.setState({\"coversList\":coversList,\"cover\":true,\"loader\":\"\"});}};_this.clickOffModal=function(){document.body.classList.remove(\"bodyModalOpen\");var visualModal=_this.state.visualModal;_this.setState({\"visualModal\":!visualModal,\"responseDetail\":[]});};_this.state={\"responsesList\":[],\"addSearch\":\"\",\"addSelect\":\"\",'makeSearch':true,'nbResult':\"\",'emptyResult':false,'visuResult':false,'seeMore':false,'visualModal':false,\"responseDetail\":[],\"coversList\":[],\"cover\":\"\",\"loader\":\"\"};_this.offset=0;return _this;}_createClass(App,[{key:\"render\",value:function render(){var _this2=this;var _this$state2=this.state,responsesList=_this$state2.responsesList,seeMore=_this$state2.seeMore,visualModal=_this$state2.visualModal,visuResult=_this$state2.visuResult,makeSearch=_this$state2.makeSearch,nbResult=_this$state2.nbResult,emptyResult=_this$state2.emptyResult,responseDetail=_this$state2.responseDetail,coversList=_this$state2.coversList,cover=_this$state2.cover,loader=_this$state2.loader;return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"main\",null,/*#__PURE__*/React.createElement(SearchForm,{submit:this.submit}),makeSearch&&/*#__PURE__*/React.createElement(\"p\",{className:\"search\"},\"Veuillez effectuer une recherche\"),visuResult&&/*#__PURE__*/React.createElement(\"p\",{className:\"result\"},nbResult,\" r\\xE9sultats\"),visuResult&&/*#__PURE__*/React.createElement(ResultsTable,{result:responsesList.map(function(r,i){return/*#__PURE__*/React.createElement(Response,Object.assign({key:i},r,{numRslt:i+1,click:_this2.clickOnModal}));})}),emptyResult&&/*#__PURE__*/React.createElement(\"p\",null,\"Aucun r\\xE9sultat pour votre recherche\"),seeMore&&/*#__PURE__*/React.createElement(\"button\",{className:\"btnSeeMore\",onClick:this.clickSeeMore},\"Voir plus\"),visualModal&&responseDetail.map(function(d,i){return/*#__PURE__*/React.createElement(Modal,Object.assign({key:i},d,{click:_this2.clickOffModal,urlList:coversList,cover:cover,loader:loader}));})));}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/marionmetais/Documents/Exercices/React JS/Projets/ecf deploiement/src/App.js"],"names":["React","Component","Header","SearchForm","ResultsTable","Response","Modal","sendSearch","sendSearchDetails","sendSearchCover","App","props","submit","ev","preventDefault","target","addSearch","addSelect","setState","value","offset","addResponse","clickSeeMore","state","response","responsesList","recordings","map","a","push","name","title","id","count","clickOnModal","idRecording","document","body","classList","add","visualModal","addDetails","responseDetail","artists","artist","releases","release","genres","genre","length","minuts","Math","floor","seconds","join","idReleases","idRelease","addCover","responseCover","coversList","images","cover","small","clickOffModal","remove","seeMore","visuResult","makeSearch","nbResult","emptyResult","loader","r","i","d"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport './App.css';\nimport Header from './components/Header';\nimport SearchForm from './components/SearchForm';\nimport ResultsTable from './components/ResultsTable';\nimport Response from './components/Response';\nimport Modal from './components/Modal';\nimport {sendSearch} from './api/musicBrainzAPI'; \nimport {sendSearchDetails} from './api/musicBrainzAPI'; \nimport {sendSearchCover} from './api/musicBrainzAPI'; \n\n\nclass App extends Component {\n\n  constructor(props){\n      super(props);\n      this.state = {\n        \"responsesList\" : [],\n        \"addSearch\": \"\",\n        \"addSelect\": \"\",\n        'makeSearch' : true,\n        'nbResult': \"\",\n        'emptyResult': false,\n        'visuResult': false,\n        'seeMore': false,\n        'visualModal': false,\n        \"responseDetail\" : [],\n        \"coversList\" : [],\n        \"cover\" : \"\",\n        \"loader\" : \"\",\n      }\n      this.offset = 0;\n    };\n\n  submit = (ev) => {\n      ev.preventDefault();\n\n      const {addSearch, addSelect} = ev.target;\n\n      this.setState({\n          \"responsesList\": [],\n          \"addSearch\": addSearch.value,\n          \"addSelect\": addSelect.value,\n      })\n\n      this.offset = 0;\n\n      sendSearch(addSelect.value, addSearch.value, this.offset, this.addResponse);\n  };\n\n  clickSeeMore = () => {\n      const {addSearch, addSelect} = this.state;\n      this.offset += 100;\n      sendSearch(addSelect, addSearch, this.offset, this.addResponse);\n  };\n\n  addResponse = (response) => {\n      const {responsesList} = this.state;\n\n      response.recordings.map(a => \n          responsesList.push({\n              \"artistName\":a[\"artist-credit\"]?.[0].name,\n              \"titleName\": a?.title,\n              \"albumName\": a[\"releases\"]?.[0].title,\n              \"idRecording\": a?.id,\n      }));\n\n      this.setState({\n          \"responsesList\": responsesList,\n      })\n\n      //pour gérer l'apparition ou non du bouton \"voir plus\"\n      if(this.offset+100 < response.count){\n          this.setState({\n              \"seeMore\": true,\n          });\n      }else{\n          this.setState({\n              \"seeMore\": false,\n          }); \n      } \n\n      //pour gérer l'apparition ou non du tableau des résultats ou d'un texte\n      if(response.count > 0){\n        this.setState({\n          \"visuResult\": true,\n          \"makeSearch\": false,\n          \"emptyResult\": false,\n          \"nbResult\" : response.count,\n        }); \n      }else{\n        this.setState({\n          \"visuResult\": false,\n          \"makeSearch\": false,\n          \"emptyResult\": true,\n        }); \n      }\n  };\n\n  clickOnModal = (idRecording) => {\n    document.body.classList.add(\"bodyModalOpen\");\n\n    const {visualModal} = this.state;\n    this.setState({\n      \"visualModal\": !visualModal,\n      \"loader\": \"loader\",\n    }); \n\n    sendSearchDetails(idRecording, this.addDetails);\n  };\n\n  addDetails = (response) => {\n    const {responseDetail} = this.state;\n\n    const artists = [];\n    for(let artist of response[\"artist-credit\"]){\n      artists.push(artist.name);\n    }\n    \n    const releases = [];\n    for(let release of response[\"releases\"]){\n      releases.push(release.title);\n    }\n\n    const genres = [];\n    for(let genre of response?.genres){\n      genres.push(genre.name);\n    }\n\n    let length = response?.length;\n    let minuts = Math.floor(length/1000/60);\n    let seconds = Math.floor((length/1000)%60);\n\n    responseDetail.push({\n        \"titleName\": response?.title,\n        \"artistName\": response[\"artist-credit\"]?.length === 0 ? \"Indisponible\" : artists.join(', '),\n        \"albumName\": response[\"releases\"].length === 0 ? \"Indisponible\" : releases.join(', '),\n        \"genre\": response?.genres.length === 0 ? \"Indisponible\" : genres.join(', '),\n        \"length\": minuts+'mn '+seconds+\"s\",\n        \"rating\": response[\"rating\"]?.value === null ? \"Indisponible\" : response[\"rating\"]?.value + \"/5\",\n      });\n\n      this.setState({\n          \"responseDetail\": responseDetail,\n      })\n\n      //récupération des id albums pour les covers\n      this.setState({\n        \"coversList\": [],\n        \"cover\": \"\",\n      })\n\n      const idReleases = [];\n      for(let release of response[\"releases\"]){\n        idReleases.push(release.id);\n      }\n\n      for(let idRelease of idReleases){\n        sendSearchCover(idRelease, this.addCover);\n      }\n  };\n\n  addCover = (responseCover) => {\n    if(responseCover === \"noCover\"){\n      this.setState({\n        \"cover\": false,\n        \"loader\": \"\",\n      })\n    }else{\n      const {coversList} = this.state;\n      for(let cover of responseCover.images){\n        coversList.push({\n          \"url\": cover['thumbnails'].small});\n      }\n\n      this.setState({\n        \"coversList\": coversList,\n        \"cover\": true,\n        \"loader\": \"\",\n      })\n    }\n  };\n\n  clickOffModal = () => {\n    document.body.classList.remove(\"bodyModalOpen\");\n\n    const {visualModal} = this.state;\n    this.setState({\n      \"visualModal\": !visualModal,\n      \"responseDetail\": [],\n    }); \n  };\n\n  render() {\n      const {responsesList, seeMore, visualModal, visuResult, makeSearch, nbResult, emptyResult, responseDetail, coversList, cover, loader} = this.state;\n      return (\n          <div>\n            <Header/>\n\n            <main>\n              <SearchForm submit={this.submit}/>\n\n              {makeSearch && <p className=\"search\">Veuillez effectuer une recherche</p>}\n\n              {visuResult && <p className=\"result\">{nbResult} résultats</p>}\n                \n              {visuResult && <ResultsTable result={responsesList.map((r,i) => <Response key={i} {...r} numRslt={i+1} click={this.clickOnModal}/>)}/> }\n\n              {emptyResult && <p>Aucun résultat pour votre recherche</p>}\n\n              {seeMore && <button className=\"btnSeeMore\" onClick={this.clickSeeMore}>Voir plus</button> }\n\n              {visualModal && responseDetail.map((d,i) => <Modal key={i} {...d} click={this.clickOffModal} urlList={coversList} cover={cover} loader={loader}/>)}\n            </main>\n\n          </div>\n      )\n  }\n}\n\nexport default App;"]},"metadata":{},"sourceType":"module"}